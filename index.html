<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZERO - Plataforma de Cinema</title>
    <meta name="description" content="Plataforma ZERO - Cat√°logo gratuito de filmes e s√©ries">
    <meta name="keywords" content="filmes, cinema, streaming, gratuito">
    <style>
        /* TODO O CSS ANTERIOR PERMANECE IGUAL */
        :root {
            --vermelho: #ff0000;
            --vermelho-escuro: #cc0000;
            --preto: #000000;
            --preto-cinza: #1a1a1a;
            --cinza: #333333;
            --branco: #ffffff;
            --cinza-claro: #888888;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: var(--preto);
            color: var(--branco);
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ... TODO O RESTANTE DO CSS PERMANECE IGUAL ... */
        
        .shared-data-warning {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid cyan;
            color: cyan;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.9em;
            text-align: center;
        }
        
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen">
        <div class="container">
            <div class="login-container">
                <h1 class="login-title">ZERO</h1>
                <h2 class="text-center">Acesso Administrativo</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Usu√°rio" id="username" required>
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" placeholder="Senha" id="password" required>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;">üîê Entrar</button>
                </form>
                <div class="text-center mt-20">
                    <button class="btn btn-secondary" onclick="skipLogin()">üé¨ Continuar como Visitante</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Plataforma Principal -->
    <div id="mainScreen" class="hidden">
        <header class="header">
            <div class="container">
                <div class="logo">ZERO</div>
                <button class="mobile-menu" onclick="toggleMobileMenu()">‚ò∞ Menu</button>
                <nav class="nav" id="mainNav">
                    <a href="#" onclick="showScreen('catalogScreen')">üé¨ Cat√°logo</a>
                    <a href="#" onclick="showAdminLogin()">üëë Admin</a>
                    <a href="#" onclick="showChangePassword()">üîí Trocar Senha</a>
                    <a href="#" onclick="logout()">üö™ Sair</a>
                </nav>
            </div>
        </header>

        <main class="container">
            <!-- Aviso de Dados Compartilhados -->
            <div id="sharedDataWarning" class="shared-data-warning">
                üåê Cat√°logo compartilhado - Todos os usu√°rios veem os mesmos filmes
            </div>

            <!-- TODO O RESTO DO HTML PERMANECE IGUAL -->
            <!-- catalogScreen, playerScreen, adminScreen, changePasswordScreen -->

        </main>
    </div>

    <script>
        // =============================================
        // SISTEMA ZERO - DADOS COMPARTILHADOS ENTRE TODOS
        // =============================================

        // Estado do Sistema
        let videos = [];
        let categories = [];
        let isAdmin = false;
        let currentMovieData = null;
        let currentSearchSource = 'manual';
        
        // Sistema de senha
        let ADMIN_USERNAME = "admin";
        let ADMIN_PASSWORD = "zero123";

        // URL do arquivo JSON compartilhado (vamos criar isso)
        const SHARED_DATA_URL = 'https://raw.githubusercontent.com/[SEU-USUARIO]/[SEU-REPOSITORIO]/main/filmes.json';

        // =============================================
        // SISTEMA DE DADOS COMPARTILHADOS
        // =============================================

        async function carregarFilmesCompartilhados() {
            try {
                console.log('üì° Carregando filmes compartilhados...');
                
                // Tenta carregar do JSON compartilhado
                const response = await fetch(SHARED_DATA_URL + '?t=' + Date.now());
                
                if (response.ok) {
                    const filmesCompartilhados = await response.json();
                    videos = filmesCompartilhados;
                    console.log(`‚úÖ ${videos.length} filmes carregados do cat√°logo compartilhado`);
                    
                    // Atualiza a interface
                    if (document.getElementById('catalogScreen') && !document.getElementById('catalogScreen').classList.contains('hidden')) {
                        loadCatalogVideos();
                    }
                    if (document.getElementById('adminScreen') && !document.getElementById('adminScreen').classList.contains('hidden')) {
                        loadAdminVideos();
                    }
                    
                    return true;
                } else {
                    throw new Error('Arquivo n√£o encontrado');
                }
            } catch (error) {
                console.log('‚ùå N√£o foi poss√≠vel carregar filmes compartilhados:', error);
                
                // Tenta carregar do localStorage como fallback
                try {
                    const savedVideos = localStorage.getItem('zero_videos_local');
                    if (savedVideos) {
                        videos = JSON.parse(savedVideos);
                        console.log(`üìÅ ${videos.length} filmes carregados do backup local`);
                        return true;
                    }
                } catch (e) {
                    console.log('‚ùå Backup local tamb√©m falhou');
                }
                
                videos = [];
                return false;
            }
        }

        async function salvarFilmesCompartilhados() {
            if (!isAdmin) {
                alert('‚ùå Apenas administradores podem salvar no cat√°logo compartilhado');
                return false;
            }

            try {
                // Em uma solu√ß√£o real, aqui teria uma API para salvar
                // Por enquanto, vamos salvar localmente e dar instru√ß√µes
                
                // 1. Salva localmente
                localStorage.setItem('zero_videos_local', JSON.stringify(videos));
                
                // 2. Prepara dados para exporta√ß√£o
                const dadosParaExportar = JSON.stringify(videos, null, 2);
                
                // 3. Mostra instru√ß√µes para o admin
                mostrarInstrucoesUpload(dadosParaExportar);
                
                console.log(`üíæ ${videos.length} filmes preparados para compartilhamento`);
                return true;
                
            } catch (error) {
                console.log('‚ùå Erro ao salvar filmes compartilhados:', error);
                alert('‚ùå Erro ao salvar cat√°logo compartilhado');
                return false;
            }
        }

        function mostrarInstrucoesUpload(dadosJSON) {
            const instrucoes = `
üéØ **PARA COMPARTILHAR COM SEUS AMIGOS:**

Siga estes passos:

1. **üìÅ Crie um arquivo chamado "filmes.json"**
2. **üìã Cole este conte√∫do:**
\`\`\`json
${dadosJSON}
\`\`\`

3. **‚¨ÜÔ∏è Fa√ßa upload no seu reposit√≥rio do GitHub**
   - V√° no seu reposit√≥rio
   - Clique em "Add file" ‚Üí "Upload files"  
   - Arraste o arquivo "filmes.json"
   - Clique "Commit changes"

4. **üîó Atualize a URL no c√≥digo:**
   - No c√≥digo, procure por: SHARED_DATA_URL
   - Troque para: https://raw.githubusercontent.com/[SEU-USUARIO]/[SEU-REPOSITORIO]/main/filmes.json

5. **‚úÖ Pronto!** Seus amigos ver√£o os mesmos filmes!

üìä **Total de filmes:** ${videos.length}
            `;
            
            // Cria um modal com as instru√ß√µes
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: var(--preto-cinza);
                    padding: 30px;
                    border-radius: 15px;
                    border: 2px solid var(--vermelho);
                    max-width: 600px;
                    max-height: 80vh;
                    overflow-y: auto;
                    color: white;
                ">
                    <h2 style="color: var(--vermelho); margin-bottom: 20px; text-align: center;">
                        üåê Compartilhar Cat√°logo
                    </h2>
                    <div style="white-space: pre-wrap; font-family: monospace; font-size: 14px; line-height: 1.4;">
                        ${instrucoes}
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                class="btn" 
                                style="background: var(--vermelho);">
                            ‚úÖ Entendi
                        </button>
                        <button onclick="copiarDadosParaAreaTransferencia()" 
                                class="btn btn-secondary" 
                                style="margin-left: 10px;">
                            üìã Copiar JSON
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function copiarDadosParaAreaTransferencia() {
            const dadosJSON = JSON.stringify(videos, null, 2);
            navigator.clipboard.writeText(dadosJSON).then(() => {
                alert('‚úÖ JSON copiado para √°rea de transfer√™ncia!');
            }).catch(() => {
                alert('‚ùå N√£o foi poss√≠vel copiar. Manualmente: Ctrl+A, Ctrl+C');
            });
        }

        // =============================================
        // SISTEMA ATUALIZADO - SALVAR SEMPRE NO COMPARTILHADO
        // =============================================

        async function addVideoManual() {
            const title = document.getElementById('manualTitle').value;
            const year = document.getElementById('manualYear').value;
            const duration = document.getElementById('manualDuration').value;
            const category = document.getElementById('manualCategory').value;
            const poster = document.getElementById('manualPoster').value;
            const embedInput = document.getElementById('videoEmbedInput').value;

            if (!title || !embedInput) {
                alert('‚ùå Preencha pelo menos o t√≠tulo e o link do v√≠deo!');
                return;
            }

            const videoCode = extractVideoCode(embedInput);
            if (!videoCode) {
                alert('‚ùå N√£o foi poss√≠vel extrair o c√≥digo do v√≠deo.');
                return;
            }

            if (!category) {
                alert('‚ùå Selecione uma categoria para o filme!');
                return;
            }

            const newVideo = {
                id: Date.now().toString(36) + Math.random().toString(36).substr(2),
                title: title,
                description: currentMovieData?.Plot || `Assista agora: ${title}`,
                category: category,
                driveId: videoCode,
                duration: duration || '2h',
                year: year || '2024',
                rating: currentMovieData?.imdbRating || '',
                tomatoRating: currentMovieData?.TomatoRating || '',
                cast: currentMovieData?.Actors || '',
                director: currentMovieData?.Director || '',
                poster: poster || currentMovieData?.Poster || generatePlaceholderPoster(title),
                date: new Date().toISOString()
            };

            videos.push(newVideo);
            
            // SALVA NO SISTEMA COMPARTILHADO
            const salvou = await salvarFilmesCompartilhados();
            
            if (salvou) {
                // Limpar formul√°rio
                document.getElementById('manualTitle').value = '';
                document.getElementById('manualYear').value = '';
                document.getElementById('manualDuration').value = '';
                document.getElementById('manualCategory').value = '';
                document.getElementById('manualPoster').value = '';
                document.getElementById('videoEmbedInput').value = '';
                document.getElementById('moviePreview').classList.add('hidden');
                document.getElementById('movieSearchInput').value = '';
                currentMovieData = null;
                
                loadAdminVideos();
                loadCatalogVideos();
                showSuccess(`‚úÖ "${title}" adicionado ao cat√°logo compartilhado!`);
            }
        }

        async function deleteVideo(videoId) {
            if (confirm('Tem certeza que deseja excluir este filme do cat√°logo compartilhado?')) {
                videos = videos.filter(v => v.id !== videoId);
                
                // SALVA NO SISTEMA COMPARTILHADO
                const salvou = await salvarFilmesCompartilhados();
                
                if (salvou) {
                    loadAdminVideos();
                    loadCatalogVideos();
                    showSuccess('‚úÖ Filme exclu√≠do do cat√°logo compartilhado!');
                }
            }
        }

        // =============================================
        // INICIALIZA√á√ÉO ATUALIZADA
        // =============================================

        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            loadVideosData();
            setupEventListeners();
            loadPasswordData();
            carregarFilmesCompartilhados(); // ‚Üê CARREGA DOS DADOS COMPARTILHADOS
            checkLoginStatus();
        });

        function initializeSystem() {
            console.log('üé¨ ZERO - Sistema com dados compartilhados');
        }

        function loadVideosData() {
            categories = [
                { id: 'acao', name: 'A√ß√£o', icon: '‚ö°' },
                { id: 'aventura', name: 'Aventura', icon: 'üèîÔ∏è' },
                { id: 'comedia', name: 'Com√©dia', icon: 'üé¨' },
                { id: 'drama', name: 'Drama', icon: 'üé≠' },
                { id: 'fantasia', name: 'Fantasia', icon: 'üßô' },
                { id: 'ficcao', name: 'Fic√ß√£o Cient√≠fica', icon: 'üöÄ' },
                { id: 'romance', name: 'Romance', icon: '‚ù§Ô∏è' },
                { id: 'suspense', name: 'Suspense', icon: 'üîç' },
                { id: 'terror', name: 'Terror', icon: 'üò®' },
                { id: 'documentario', name: 'Document√°rio', icon: 'üé•' }
            ];
        }

        // =============================================
        // BOT√ÉO PARA ATUALIZAR MANUALMENTE
        // =============================================

        function adicionarBotaoAtualizar() {
            // Adiciona um bot√£o de atualizar no admin
            const adminCard = document.querySelector('.admin-card h3.card-title');
            if (adminCard) {
                const botaoAtualizar = document.createElement('button');
                botaoAtualizar.className = 'btn btn-small';
                botaoAtualizar.style.marginLeft = '10px';
                botaoAtualizar.innerHTML = 'üîÑ Atualizar Cat√°logo';
                botaoAtualizar.onclick = async function() {
                    botaoAtualizar.textContent = 'üì° Atualizando...';
                    botaoAtualizar.classList.add('loading');
                    
                    const sucesso = await carregarFilmesCompartilhados();
                    
                    botaoAtualizar.textContent = 'üîÑ Atualizar Cat√°logo';
                    botaoAtualizar.classList.remove('loading');
                    
                    if (sucesso) {
                        showSuccess(`‚úÖ Cat√°logo atualizado! ${videos.length} filmes carregados.`);
                    } else {
                        showError('‚ùå Erro ao atualizar cat√°logo');
                    }
                };
                
                adminCard.parentElement.insertBefore(botaoAtualizar, adminCard.nextSibling);
            }
        }

        // ... (TODO O RESTO DO C√ìDIGO ANTERIOR PERMANECE)

        // Fun√ß√µes auxiliares (do c√≥digo anterior)
        function extractVideoCode(input) {
            if (!input) return null;
            if (/^[a-zA-Z0-9]+$/.test(input.trim())) return input.trim();
            const patterns = [/vid=([a-zA-Z0-9]+)/, /&vid=([a-zA-Z0-9]+)/, /\?.*?vid=([a-zA-Z0-9]+)/];
            for (const pattern of patterns) {
                const match = input.match(pattern);
                if (match && match[1]) return match[1];
            }
            return null;
        }

        function generatePlaceholderPoster(movieName) {
            const text = movieName.length > 15 ? movieName.substring(0, 15) + '...' : movieName;
            return `https://via.placeholder.com/500x750/333333/FFFFFF?text=${encodeURIComponent(text)}`;
        }

        // Adiciona o bot√£o quando a tela admin carrega
        function loadAdminVideos() {
            // ... c√≥digo anterior do loadAdminVideos
            adicionarBotaoAtualizar();
        }

    </script>
</body>
</html>